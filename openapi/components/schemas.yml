UUID:
  type: string
  format: uuid
  example: 123e4567-e89b-12d3-a456-426614174000

ReadOnlyUUID:
  allOf:
    - $ref: "#/UUID"
    - readOnly: true

UUIDList:
  type: array
  items:
    $ref: "#/UUID"

ErrorResponse:
  type: object
  required: [message]
  properties:
    message:
      type: string
      description: Сообщение об ошибке
      example: "Something went wrong"

UserLogin:
  type: object
  required: [login]
  properties:
    login:
      type: string
      description: Логин пользователя
      example: user123

UserPassword:
  type: object
  required: [password]
  properties:
    password:
      type: string
      description: Пароль пользователя
      example: mysecurepassword

UserName:
  type: object
  required: [name]
  properties:
    name:
      type: string
      description: Имя пользователя
      example: Иван Иванов

UserLoginPassword:
  allOf:
    - $ref: "#/UserLogin"
    - $ref: "#/UserPassword"

UserRegister:
  allOf:
    - $ref: "#/UserLogin"
    - $ref: "#/UserPassword"
    - $ref: "#/UserName"

UserId:
  type: object
  required: [id]
  properties:
    id:
      $ref: "#/UUID"

User:
  allOf:
    - $ref: "#/UserLogin"
    - $ref: "#/UserName"
    - $ref: "#/UserId"

RoleEnum:
  type: string
  enum: [owner, admin, participant]
  description: Роль пользователя в мероприятии
  example: owner

UserRole:
  type: object
  properties:
    role:
      $ref: "#/RoleEnum"

UserInEvent:
  allOf:
    - $ref: "#/User"
    - type: object
      properties:
        user_role:
          $ref: "#/RoleEnum"
        balance:
          type: number
          description: Баланс пользователя в мероприятии (сумма долгов)
          example: 200

UsersInEvent:
  type: array
  items:
    $ref: "#/UserInEvent"

Event:
  type: object
  properties:
    event_id:
      $ref: "#/ReadOnlyUUID"
    user_role:
      readOnly: true
      allOf:
        - $ref: "#/RoleEnum"
    title:
      type: string
      description: Название мероприятия
      example: "Встреча с друзьями"
    location:
      type: string
      description: Место мероприятия
      example: Политехническая улица, 29 лит П
    start_datetime:
      type: string
      format: date-time
      description: Дата и время начала мероприятия
      example: "2025-01-01T10:00:00Z"
    end_datetime:
      type: string
      format: date-time
      description: Дата и время окончания мероприятия
      example: "2025-01-01T12:00:00Z"
    description:
      type: string
      description: Описание мероприятия
      example: "Встреча с друзьями в кафе"
    budget:
      readOnly: true
      type: number
      description: Бюджет мероприятия
      example: 10000
    is_finalized:
      readOnly: true
      type: boolean
      description: Флаг, который показывает завершено ли мероприятие или нет.
      example: false

InvitationToken:
  type: object
  properties:
    invitation_token:
      type: string
      description: Токен-приглашение
      example: "0fab8e08-4b0d-4a3d-9771-9f6c6a9d5a1c"

Events:
  type: array
  items:
    $ref: "#/Event"

ShoppingItem:
  type: object
  properties:
    shopping_item_id:
      $ref: "#/ReadOnlyUUID"
    title:
      type: string
      description: Название элемента списка покупок
      example: "Яблоки"
    quantity:
      type: number
      description: Количество элемента списка покупок
      example: 10
    unit:
      type: string
      description: Единицы измерения
      example: "шт"
    is_purchased:
      readOnly: true
      type: boolean
      description: Признак того, что элемент списка покупок куплен
      example: false

ShoppingItems:
  type: array
  items:
    $ref: "#/ShoppingItem"

ShoppingItemPurchasedState:
  type: object
  properties:
    is_purchased:
      type: boolean
      description: Признак того, что элемент списка покупок куплен
      example: false

CreateShoppingListRequest:
  type: object
  properties:
    title:
      type: string
      description: Название списка покупок
      example: "Купить фрукты"
    description:
      type: string
      description: Описание списка покупок
      example: "Купить фрукты для вечеринки"

ShoppingListBudget:
  type: object
  properties:
    budget:
      type: number
      description: Бюджет списка покупок
      example: 1000

ShoppingListWithItems:
  type: object
  properties:
    shopping_list_id:
      $ref: "#/ReadOnlyUUID"
    task_id:
      $ref: "#/ReadOnlyUUID"
    title:
      type: string
      description: Название задачи
      example: "Купить фрукты"
    description:
      type: string
      description: Описание списка покупок
      example: "Купить фрукты для вечеринки"
    status:
      readOnly: true
      type: string
      enum:
        [unassigned, assigned, in_progress, bought, partially_bought, cancelled]
      description: Статус списка покупок
      example: unassigned
    can_edit:
      readOnly: true
      type: boolean
      description: Может ли пользователь редактировать список покупок
      example: true
    budget:
      readOnly: true
      type: number
      description: Реальная стоимость списка покупок
      example: 499.99
    shopping_items:
      readOnly: true
      type: array
      items:
        $ref: "#/ShoppingItem"
    consumers:
      readOnly: true
      type: array
      items:
        $ref: "#/UserInEvent"

ShoppingListsWithItems:
  type: array
  items:
    $ref: "#/ShoppingListWithItems"

TaskExecutorId:
  type: object
  properties:
    executor_id:
      description: Идентификатор исполнителя задачи
      $ref: "#/UUID"

TaskCreateRequest:
  type: object
  properties:
    title:
      type: string
      description: Название задачи
      example: "Купить фрукты"
    description:
      type: string
      description: Описание задачи
      example: "Купить фрукты для вечеринки"
    deadline_datetime:
      type: string
      format: date-time
      description: Дедлайн задачи
      example: "2025-01-01T12:00:00Z"
    executor_id:
      $ref: "#/UUID"
    shopping_lists_ids:
      type: array
      items:
        $ref: "#/UUID"

TaskPatchRequest:
  type: object
  properties:
    title:
      type: string
      description: Название задачи
      example: "Купить фрукты"
    description:
      type: string
      description: Описание задачи
      example: "Купить фрукты для вечеринки"
    deadline_datetime:
      type: string
      format: date-time
      description: Дедлайн задачи
      example: "2025-01-01T12:00:00Z"

Task:
  type: object
  properties:
    task_id:
      $ref: "#/ReadOnlyUUID"
    title:
      type: string
      description: Название задачи
      example: "Купить фрукты"
    description:
      type: string
      description: Описание задачи
      example: "Купить фрукты для вечеринки"
    status:
      type: string
      enum: [open, in_progress, under_review, completed]
      description: Статус задачи
    deadline_datetime:
      type: string
      format: date-time
      description: Дедлайн задачи
      example: "2025-01-01T12:00:00Z"
    executor_comment:
      type: string
      description: Комментарий исполнителя
      example: "Задача выполнена"
    reviewer_comment:
      type: string
      description: Комментарий проверяющего
      example: "Подтверждаю выполнение задачи"
    permissions:
      type: object
      properties:
        can_edit:
          type: boolean
          description: Может ли пользователь редактировать задачу
          example: true
        can_take_in_work:
          type: boolean
          description: Может ли пользователь взять задачу в работу
          example: true
        can_review:
          type: boolean
          description: Может ли пользователь подтвердить или отклонить задачу
          example: true
    author:
      allOf:
        - $ref: "#/User"
    executor:
      allOf:
        - $ref: "#/User"

TaskWithShoppingLists:
  allOf:
    - $ref: "#/Task"
    - type: object
      properties:
        shopping_lists:
          type: array
          items:
            $ref: "#/ShoppingListsWithItems"

Tasks:
  type: array
  items:
    $ref: "#/Task"

TaskSendForReviewRequest:
  type: object
  properties:
    executor_comment:
      type: string
      description: Комментарий исполнителя
      example: "Задача выполнена"

TaskReviewRequest:
  type: object
  properties:
    reviewer_comment:
      type: string
      description: Комментарий проверяющего
      example: "Подтверждаю выполнение задачи"
    is_approved:
      type: boolean
      description: Признак того, что задача одобрена

UserBalance:
  type: object
  properties:
    my_debts:
      type: array
      items:
        $ref: "#/Debt"
    debts_to_me:
      type: array
      items:
        $ref: "#/Debt"

Debt:
  type: object
  properties:
    user:
      $ref: "#/User"
    amount:
      type: number
      description: Сумма долга
      example: 1000

EventBalanceSummary:
  type: array
  items:
    type: object
    properties:
      user:
        $ref: "#/User"
      total_balance:
        type: number
        description: Сумма долгов пользователя в мероприятии (может быть отрицательной)
        example: 200
      user_balance:
        $ref: "#/UserBalance"
